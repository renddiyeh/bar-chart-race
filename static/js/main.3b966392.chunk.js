(this["webpackJsonpbar-chart-race"]=this["webpackJsonpbar-chart-race"]||[]).push([[0],{131:function(t,e,n){"use strict";n.r(e);var r=n(3),a=n(2),o=n.n(a),i=n(47),c=n.n(i),s=(n(86),n(10)),u=n(12),l=n(42),f=n(144),d=n(145),j=n(150),h=n(133),b=n(146),x=n(148),O=n(142),m=n(54),p=n(147),k=n(141),y=function(t){var e=t.domainMax,n=t.xMax,a=t.yMax,o=n>500?5:Math.floor(n/100),i=Object(d.a)({domain:[0,e],range:[0,n]});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(k.a,{scale:i,left:0,top:-8,width:n,height:a,stroke:"#e0e0e0"}),Object(r.jsx)(p.a,{top:-10,left:0,scale:i,hideAxisLine:!0,tickLabelProps:function(){return{textAnchor:"middle",dy:"-0.5em",fontSize:12,fontFamily:"Noto Sans TC"}},numTicks:o})]})},g=Object(O.animated)(y),v=Object(a.forwardRef)((function(t,e){var n=t.domainMax,o=t.xMax,i=t.duration,c=Object(a.useRef)(n).current,s=Object(m.useSpring)({from:{domainMax:c},to:{domainMax:n},duration:i,ref:e});return Object(r.jsx)(g,Object(u.a)({xMax:o},s))})),w=n(143),S=n(151),M=n(152),C=Object(x.a)(".2s"),F=function(t){var e=t.color,n=t.x,i=t.y,c=t.width,s=t.height,u=t.name,l=t.value,f=t.author,d=t.id,j=t.xMax,h=Object(a.useMemo)((function(){var t=f.length,e=Math.floor(t/2);return t>8?"".concat(f.substring(0,e),"\n").concat(f.substring(e)):f}),[f]),b=Math.min(c,j);return Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(M.a,{id:"clip-".concat(d),x:n,y:i,width:c,height:s}),Object(r.jsx)(w.a,{x:n,y:i,width:c,height:s,fill:e,stroke:"black",strokeWidth:"1"}),Object(r.jsx)(S.a,{x:n-10,y:i+s/2,textAnchor:"end",verticalAnchor:"middle",fontFamily:"Noto Sans TC",width:50,fontSize:"14px",children:h}),Object(r.jsx)(S.a,{x:n+b-10,y:i+4+s/2,textAnchor:"end",fontWeight:"500",fontFamily:"Noto Sans TC",fontSize:"14px",clipPath:"url(#clip-".concat(d,")"),children:u}),Object(r.jsx)(S.a,{x:n+b+10,y:i+5+s/2,fontFamily:"Noto Sans TC",fontSize:"20px",fontWeight:"700",fill:"#333333",children:C(l)})]})},W=Object(O.animated)(F),T=Object(a.forwardRef)((function(t,e){var n=t.frameData,o=t.xScale,i=t.yScale,c=t.colorScale,s=t.duration,u=t.xMax,l=Object(m.useTransition)(n.map((function(t,e){var n=t.name,r=t.value,a=t.category,c=t.author,s=t.id;return{y:i(e),width:o(r),value:r,name:n,category:a,author:c,key:s}})),{key:function(t){return t.key},initial:function(t){return t},from:{y:i.range()[1]+50,width:0,value:0},leave:{y:i.range()[1]+50,width:0,value:0},enter:function(t){return t},update:function(t){return t},ref:e,duration:s}),f=Object(a.useMemo)((function(){return{x:o(0),height:i.bandwidth()}}),[]),d=f.x,j=f.height;return l((function(t,e){var n=t.y,a=t.value,o=t.width,i=e.category,s=e.name,l=e.author,f=e.key;return Object(r.jsx)(W,{x:d,y:n,width:o,height:j,color:c(i),value:a.interpolate((function(t){return t.toFixed()})),name:s,author:l,id:f,xMax:u},f)}))})),z=["\u6587\u5b78\u5c0f\u8aaa","\u5546\u696d\u7406\u8ca1","\u751f\u6d3b\u65c5\u904a","\u5fc3\u7406\u52f5\u5fd7","\u5176\u4ed6"],E=Object(f.a)({domain:z,range:["#F27E7E","#80D2FF","#61C67E","#FFC027","#CCCCCC"]}),A=Object(x.a)(".2s"),N=o.a.forwardRef((function(t,e){var n=t.numOfBars,o=t.width,i=t.height,c=t.margin,f=t.keyframes,x=t.onStart,O=t.onStop,m=t.duration,p=Object(a.useState)({frameIdx:0,animationKey:0,playing:!1}),k=Object(s.a)(p,2),y=k[0],g=y.frameIdx,w=y.animationKey,S=y.playing,M=k[1],C=Object(a.useRef)();Object(a.useEffect)((function(){!C.current&&S&&(C.current=setTimeout((function(){C.current=null,M((function(t){var e=t.frameIdx,n=t.playing,r=Object(l.a)(t,["frameIdx","playing"]),a=e===f.length-1,o=a?e:e+1;return Object(u.a)(Object(u.a)({},r),{},{frameIdx:n?o:e,playing:!(!n||a)})}))}),m))}));var F=Object(a.useRef)(),W=Object(a.useRef)();Object(a.useImperativeHandle)(e,(function(){return{replay:function(){clearTimeout(C.current),C.current=null,M((function(t){var e=t.animationKey,n=Object(l.a)(t,["animationKey"]);return Object(u.a)(Object(u.a)({},n),{},{frameIdx:0,animationKey:e+1,playing:!0})}))},start:function(){M((function(t){return Object(u.a)(Object(u.a)({},t),{},{playing:!0})}))},stop:function(){M((function(t){return Object(u.a)(Object(u.a)({},t),{},{playing:!1})})),F.current.stop(),W.current.stop()},playing:S}}));var N=Object(a.useRef)(S);Object(a.useEffect)((function(){N.current!==S&&(S?x():O()),N.current=S}),[S]),Object(a.useLayoutEffect)((function(){F.current&&S&&(F.current.start(),W.current.start())}));var R=f[g],I=R.date,L=R.data,D=L.map((function(t){return t.value})).reduce((function(t,e){return t+e}),0),H=o-c.left-c.right,K=i-c.top-c.bottom,B=2*Math.pow(10,4),P=Object(d.a)({domain:[0,B],range:[0,H]}),Z=Object(a.useMemo)((function(){return Object(j.a)({domain:z.map((function(t,e){return e})),range:[.1*o,.9*o]})}),[o]),J=Object(a.useMemo)((function(){return Object(j.a)({domain:Array(n).fill(0).map((function(t,e){return e})),range:[0,K],paddingInner:.2})}),[n,K]),Q="Q".concat(Math.floor(I.getMonth()/3)+1),V=o/40,Y=A(D);return Object(r.jsxs)("svg",{width:o,height:i,children:[Object(r.jsxs)(h.a,{top:4,left:94,children:[Object(r.jsx)("path",{d:"M486.88,28.87H450.06v29.4a3.55,3.55,0,0,0,3.54,3.54h33.28L474,45.34Z",fill:"#f7931e",stroke:"#000","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.12"}),Object(r.jsx)("path",{d:"M1.06,28.87H37.88v29.4a3.55,3.55,0,0,1-3.54,3.54H1.06L13.92,45.34Z",fill:"#f7931e",stroke:"#000","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.12"}),Object(r.jsx)("rect",{x:"30.06",y:"1.06",width:"428",height:"54.69",rx:"4.66","stroke-width":"2.12",stroke:"#000","stroke-linecap":"round","stroke-linejoin":"round",fill:"#ffc027"}),Object(r.jsx)("text",{transform:"translate(49.34 37.42)","font-size":"28","font-family":"Noto Sans TC","letter-spacing":"0.08em",fontWeight:"bold",children:"100\u79d2\u770b\u5b8c\u4e2d\u6587\u66f8\u5341\u5e74\u66a2\u92b7\u699c"}),Object(r.jsxs)("g",{children:[Object(r.jsx)("line",{x1:"37.88",y1:"6.41",x2:"449.97",y2:"6.41",fill:"#ffc027",stroke:"#000","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"}),Object(r.jsx)("line",{x1:"37.88",y1:"50.41",x2:"449.97",y2:"50.41",fill:"#ffc027",stroke:"#000","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"})]})]}),Object(r.jsx)(b.a,{scale:E,children:function(t){return Object(r.jsx)(h.a,{top:"90",left:"76",children:t.map((function(t,e){var n=Z(e);return Object(r.jsxs)(h.a,{left:n,children:[Object(r.jsx)("rect",{fill:t.value,width:20,height:20,strokeWidth:"1",stroke:"black"}),Object(r.jsx)("text",{x:26,y:16,fontSize:V,fontWeight:"500",fontFamily:"Noto Sans TC",children:t.text})]},e)}))})}}),Object(r.jsx)("line",{x1:"0",y1:"120",x2:o,y2:"120",stroke:"black",strokeWidth:"2"}),Object(r.jsxs)(h.a,{top:c.top,left:c.left,children:[Object(r.jsx)(T,{frameData:L.slice(0,n),xScale:P,yScale:J,colorScale:E,duration:m,xMax:H,ref:F}),Object(r.jsxs)("text",{textAnchor:"end",fontSize:"2em",x:H+c.right,y:K-58,fontWeight:"700",fontFamily:"Noto Sans TC",fill:"#333333",children:[I.getFullYear(),"\u5e74",Object(r.jsxs)("tspan",{fontSize:"1.5em",fill:"#ffc027",stroke:"black",strokeWidth:"2",children:[" ",Q]})]}),Object(r.jsx)("line",{x1:H+c.right-180,y1:K-42,x2:H+c.right,y2:K-42,stroke:"#b3b3b3",strokeWidth:"3",strokeDasharray:"16",strokeLinecap:"round"}),Object(r.jsx)(h.a,{left:H-120,top:K-30,children:Object(r.jsxs)("g",{children:[Object(r.jsx)("path",{d:"M9.25,6.48,7.32,3.59,5.39.69a.64.64,0,0,0-1,0L2.44,3.59.52,6.48c-.23.34,0,.77.51.77H3.67V27.52a1.21,1.21,0,1,0,2.42,0V7.25H8.74A.52.52,0,0,0,9.25,6.48Z",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.87"}),Object(r.jsxs)("g",{children:[Object(r.jsx)("rect",{x:"22.35",y:"2.35",width:"17.25",height:"21.28","stroke-width":"1.15",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round",fill:"#fff"}),Object(r.jsx)("rect",{x:"18.9",y:"5.23",width:"17.25",height:"21.28","stroke-width":"0.86",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round",fill:"#fbb03b"}),Object(r.jsx)("polygon",{points:"22.35 2.35 18.9 5.22 36.15 5.22 39.6 2.35 22.35 2.35",fill:"#f7931e",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.86"}),Object(r.jsx)("polygon",{points:"36.15 26.5 39.6 23.63 39.6 2.35 36.15 5.22 36.15 26.5",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.86"}),Object(r.jsx)("line",{x1:"37.88",y1:"5.97",x2:"37.88",y2:"23.05",fill:"#fff",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.58"}),Object(r.jsx)("rect",{x:"14.76",y:"8.56",width:"17.25",height:"21.28","stroke-width":"1.15",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round",fill:"#fff"}),Object(r.jsx)("rect",{x:"11.31",y:"11.44",width:"17.25",height:"21.28","stroke-width":"0.86",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round",fill:"#fbb03b"}),Object(r.jsx)("polygon",{points:"14.76 8.56 11.31 11.44 28.56 11.44 32.01 8.56 14.76 8.56",fill:"#f7931e",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.86"}),Object(r.jsx)("polygon",{points:"28.56 32.71 32.01 29.84 32.01 8.56 28.56 11.44 28.56 32.71",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.86"}),Object(r.jsx)("line",{x1:"30.29",y1:"12.18",x2:"30.29",y2:"29.26",fill:"#fff",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.58"})]}),Object(r.jsx)("line",{x1:"1.18",y1:"12.02",x2:"1.18",y2:"20.08",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.85"}),Object(r.jsx)("line",{x1:"8.31",y1:"22.18",x2:"8.31",y2:"27.84",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.87"}),Object(r.jsx)("line",{x1:"8.31",y1:"19.61",x2:"8.31",y2:"17.98",fill:"#f2f2f2",stroke:"#1a1a1a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0.87"})]})}),Object(r.jsxs)("text",{textAnchor:"start",fontSize:"1.125em",x:H+c.right-130,y:K,fontWeight:"700",fontFamily:"Noto Sans TC",fill:"#333333",children:[Object(r.jsx)("tspan",{dy:"-1em",children:"\u92b7\u552e"}),Object(r.jsx)("tspan",{dy:"1.125em",dx:"-2em",children:"\u7e3d\u91cf"}),Object(r.jsx)("tspan",{dx:"0.25em",dy:"-0.125em",fontSize:"2em",children:Y})]}),Object(r.jsx)(v,{domainMax:B,xMax:H,yMax:K,duration:m,ref:W})]},w),Object(r.jsx)("line",{x1:0,y1:i-c.bottom+30,x2:o,y2:i-c.bottom+30,stroke:"black",strokeWidth:"2"}),Object(r.jsx)("rect",{x:0,y:i-c.bottom+30,width:o,height:c.bottom-30,fill:"#CCCCCC"}),Object(r.jsx)("text",{fontSize:"16px",x:o/2,y:i-16,textAnchor:"middle",fontFamily:"Noto Sans TC",fontWeight:"bold",children:"\u535a\u5ba2\u4f86 x Re-lab \u5171\u540c\u88fd\u4f5c"})]})}));N.defaultProps={width:600,height:450,margin:{top:0,right:0,bottom:0,left:100}};var R=N,I=n(29),L=n(41),D=n(149),H=n(59),K=function(t,e){var n=function(t){var e=new Map;return t.forEach((function(t){var n=t.date,r=t.name;if(e.get(n)){var a=Object(u.a)(Object(u.a)({},e.get(n)),{},Object(L.a)({},r,t));e.set(n,a)}else e.set(n,Object(L.a)({},r,t))})),function(t){var n=t.date,r=t.name;try{return e.get(n)[r]}catch(a){return null}}}(t),r=new Set(t.map((function(t){return t.name}))),a=Object(I.a)(r),o=new Set(t.map((function(t){return t.date}))),i=Object(I.a)(o).sort().map((function(t){return{date:t,data:a.map((function(e){var r=n({date:t,name:e});return Object(u.a)(Object(u.a)({},r),{},{value:r?r.value:0})}))}}));return i.reduce((function(t,r,a){var o=r,c=a!==i.length-1?i[a+1]:null;if(c)for(var s=new Date(o.date).getTime(),f=new Date(c.date).getTime()-s,d=function(a){var o=new Date(s+f*a/e),i=r.data.map((function(t){var r=t.name,o=t.value,i=Object(l.a)(t,["name","value"]),s=o,f=n({date:c.date,name:r}),d=s+((f?f.value:0)-s)*a/e;return Object(u.a)({name:r,value:d},i)}));t.push({date:o,data:i})},j=0;j<e;j++)d(j);else t.push(Object(u.a)(Object(u.a)({},r),{},{date:new Date(r.date)}));return t}),[]).map((function(t){return{date:t.date,data:t.data.sort((function(t,e){return e.value-t.value}))}}))};var B=function(t,e){var n=o.a.useState([]),r=Object(s.a)(n,2),a=r[0],i=r[1];return o.a.useEffect((function(){Object(D.a)(t).then((function(t){var n=Object(H.range)(2010,2021).reduce((function(e,n){return Object(H.range)(4).forEach((function(r){var a="".concat(n,"/Q").concat(r+1),o=t.filter((function(t){return t[a]})).map((function(t){return{date:[n,String(3*r+1).padStart(2,"0"),"01"].join("-"),id:t["\u5e8f"],name:t["\u66f8\u540d"],author:t["\u4f5c\u8005"],category:t["\u5206\u985e"],value:Number(t[a]||0)}}));Array.prototype.push.apply(e,o)})),e}),[]),r=K(n,e);i(r)}))}),[t,e]),a};var P=n.p+"static/media/data.4f46ef4e.tsv",Z={top:180,right:60,bottom:76,left:120},J=667/640;var Q=function(){var t=Object(a.useState)(250),e=Object(s.a)(t,2),n=e[0],i=e[1],c=function(){var t=function(){return{width:window.innerWidth,height:window.innerHeight}},e=o.a.useState(t),n=Object(s.a)(e,2),r=n[0],a=n[1];return o.a.useEffect((function(){var e=function(){a(t)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),r}().width,u=Math.min(720,c)-64,l=B(P,10),f=o.a.useRef(),d=!!f.current&&f.current.playing,j=Object(a.useState)(),h=Object(s.a)(j,2),b=(h[0],h[1]);return Object(r.jsx)("div",{style:{margin:"0 auto",maxWidth:720},children:Object(r.jsxs)("div",{style:{paddingTop:"1em"},children:[Object(r.jsx)("button",{onClick:function(){f.current.replay()},children:"replay"}),Object(r.jsx)("button",{onClick:d?function(){f.current.stop()}:function(){f.current.start()},children:d?"stop":"start"}),Object(r.jsx)("input",{type:"number",step:"50",min:"100",max:"1000",onChange:function(t){return i(1*t.target.value)},value:n}),Object(r.jsx)("div",{style:{height:"2em"}}),l.length>0&&Object(r.jsx)(R,{keyframes:l,numOfBars:10,width:u,height:u*J,margin:Z,onStart:function(){return b(!0)},onStop:function(){return b(!1)},ref:f,duration:n,ratio:J})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(Q,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},86:function(t,e,n){}},[[131,1,2]]]);
//# sourceMappingURL=main.3b966392.chunk.js.map